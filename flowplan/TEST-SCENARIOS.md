# מדריך תרחישי בדיקות - FlowPlan

## 1. ניהול פרויקטים

### 1.1 יצירת פרויקט חדש
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | יצירת פרויקט עם כל השדות | שם, תיאור, תאריך התחלה וסיום | פרויקט נוצר + שלב "כללי" נוצר אוטומטית |
| 2 | יצירת פרויקט ללא שם | שדה שם ריק | שגיאת ולידציה - שם הוא שדה חובה |
| 3 | תאריך סיום לפני תאריך התחלה | התחלה: 2026-03-01, סיום: 2026-02-01 | שגיאת ולידציה - טווח תאריכים לא תקין |

### 1.2 עריכת פרויקט
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | עדכון שם פרויקט | שם חדש | השם מתעדכן בכל המקומות |
| 2 | שינוי סטטוס ל-completed | סטטוס: completed | הפרויקט מסומן כהושלם |
| 3 | שינוי סטטוס ל-archived | סטטוס: archived | הפרויקט מוסתר מהתצוגה הראשית |

---

## 2. ניהול משימות

### 2.1 יצירת משימה
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | משימה עם ערכי ברירת מחדל | כותרת בלבד | duration=1, status=pending, priority=medium, percent_complete=0 |
| 2 | משימה עם כל השדות | כותרת, תיאור, עדיפות, משך, שעות, מבצע | כל הערכים נשמרים כמו שהוזנו |
| 3 | משימה ללא כותרת | שדה כותרת ריק | שגיאת ולידציה |
| 4 | משימה עם משך שלילי | duration=-1 | שגיאת ולידציה |

### 2.2 עדכון סטטוס משימה
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | שינוי ל-in_progress | status: in_progress | percent_complete = max(1%, ערך נוכחי), actual_start_date מתעדכן |
| 2 | שינוי ל-done | status: done | percent_complete = 100%, actual_finish_date מתעדכן |
| 3 | חזרה ל-pending | status: pending | percent_complete = 0% |

### 2.3 עדכון אחוז התקדמות
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | הגדרת 0% | percent_complete: 0 | status = pending |
| 2 | הגדרת 50% | percent_complete: 50 | status = in_progress, actual_start_date מתמלא |
| 3 | הגדרת 100% | percent_complete: 100 | status = done, actual_finish_date מתמלא |
| 4 | הורדה מ-100% ל-80% | percent_complete: 80 | status = in_progress, actual_finish_date מתאפס |

### 2.4 מחיקת משימה
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | מחיקת משימה ללא תלויות | משימה בודדת | המשימה נמחקת |
| 2 | מחיקת משימה עם תלויות | משימה שהיא predecessor | התלויות נמחקות יחד עם המשימה |

---

## 3. תזמון CPM (נתיב קריטי)

### 3.1 חישוב Forward Pass
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | משימה ללא קודמים | משימה בודדת, duration=5 | ES = תאריך התחלת הפרויקט, EF = ES + 5 ימי עבודה |
| 2 | שרשרת של 3 משימות (FS) | A→B→C | ES(B) = EF(A), ES(C) = EF(B) |
| 3 | שני קודמים (FS) | A→C, B→C | ES(C) = max(EF(A), EF(B)) |
| 4 | תלות SS עם lag=2 | A-SS->B, lag=2 | ES(B) = ES(A) + 2 |
| 5 | תלות FF | A-FF->B | EF(B) >= EF(A) |
| 6 | תלות SF | A-SF->B | EF(B) >= ES(A) |

### 3.2 חישוב Backward Pass
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | משימה אחרונה | ללא עוקבים | LF = EF של כל הפרויקט |
| 2 | משימה על הנתיב הקריטי | slack = 0 | LS = ES, LF = EF |
| 3 | משימה עם מרווח | slack > 0 | LS > ES |

### 3.3 נתיב קריטי
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | זיהוי נתיב קריטי | רשת משימות | משימות עם slack=0 מסומנות כ-is_critical=true |
| 2 | שינוי משך משימה קריטית | הארכת duration | הנתיב הקריטי מתעדכן |
| 3 | הוספת תלות חדשה | dependency חדש | CPM מחושב מחדש |

### 3.4 ימי עבודה ולוח שנה
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | משימה שחוצה שבת | duration=3, מתחילה ביום ד' | דילוג על שישי-שבת (ברירת מחדל: א'-ה') |
| 2 | משימה שחוצה חג | duration=2, חג באמצע | משך אפקטיבי = 3 ימים קלנדריים |
| 3 | חריגה רב-יומית | חופשת פסח (7 ימים) | כל הימים מדולגים בחישוב |

### 3.5 אילוצים (Constraints)
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | ASAP (ברירת מחדל) | ללא אילוץ | תזמון מוקדם ככל האפשר |
| 2 | MSO - חייב להתחיל ב- | constraint_date: 2026-04-01 | ES = 2026-04-01 בדיוק |
| 3 | SNET - לא לפני | constraint_date: 2026-04-01 | ES >= 2026-04-01 |
| 4 | FNLT - לסיים לא אחרי | constraint_date: 2026-04-15 | LF <= 2026-04-15 |

### 3.6 משימות ידניות מול אוטומטיות
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | משימה אוטומטית | scheduling_mode: auto | תאריכים מחושבים ע"י CPM |
| 2 | משימה ידנית | scheduling_mode: manual | start_date נשמר כפי שהמשתמש הגדיר |
| 3 | משימה שהושלמה | percent_complete: 100 | ES/EF מוקפאים - לא מחושבים מחדש |

---

## 4. תלויות בין משימות

### 4.1 יצירת תלות
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | תלות FS רגילה | A→B, type=FS, lag=0 | B מתחילה כש-A מסתיימת |
| 2 | תלות עם lag חיובי | A→B, lag=3 | B מתחילה 3 ימים אחרי סיום A |
| 3 | תלות עם lag שלילי (lead) | A→B, lag=-2 | B יכולה להתחיל 2 ימים לפני סיום A |
| 4 | תלות עצמית | A→A | שגיאה - לא ניתן ליצור תלות עצמית |
| 5 | תלות מעגלית | A→B→C→A | שגיאה - זוהתה תלות מעגלית |

---

## 5. ניהול שלבים (Phases)

### 5.1 שלבים
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | שלב ברירת מחדל | יצירת פרויקט חדש | שלב "כללי" נוצר אוטומטית |
| 2 | יצירת שלב נוסף | שם, תיאור | שלב נוסף ברשימה |
| 3 | סדר שלבים | 3 שלבים | phase_order משקף את הסדר הנכון |

### 5.2 נעילת שלבים
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | שלב ראשון | תמיד | לא נעול (unlocked) |
| 2 | שלב שני כשהראשון לא הושלם | שלב 1: active | שלב 2 נעול + הודעה מי חוסם |
| 3 | שלב שני כשהראשון הושלם | שלב 1: completed | שלב 2 נפתח |

### 5.3 סטטוס שלב אוטומטי
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | כל המשימות pending | 3 משימות pending | סטטוס שלב: pending |
| 2 | חלק מהמשימות בביצוע | 1 in_progress, 2 pending | סטטוס שלב: active |
| 3 | כל המשימות done | 3 משימות done | סטטוס שלב: completed |

---

## 6. צוות ומשאבים

### 6.1 חברי צוות
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | הוספת חבר צוות | שם, אימייל, תפקיד | חבר צוות חדש נוסף |
| 2 | עדכון שעות עבודה | work_hours_per_day: 6 | CPM לוקח בחשבון 6 שעות ליום |
| 3 | עדכון ימי עבודה | work_days: [0,1,2,3] (א'-ד') | CPM מדלג על ימים שלא עובדים |

### 6.2 הקצאת משימות (Multi-Assignee)
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | הקצאת מבצע בודד | user_id, allocated_hours=8 | ההקצאה נשמרת |
| 2 | הקצאת מספר מבצעים | 3 מבצעים | כולם מופיעים ב-AvatarStack |
| 3 | הסרת הקצאה | מחיקת assignment | המבצע מוסר מהמשימה |

### 6.3 חופשות
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | הגשת בקשת חופשה | תאריכים, סוג: vacation | סטטוס: pending |
| 2 | אישור חופשה | status: approved | החופשה משפיעה על תזמון CPM |
| 3 | דחיית חופשה | status: rejected | אין השפעה על תזמון |
| 4 | חופשה חופפת למשימה | חופשה בזמן משימה | משך המשימה מתארך |

---

## 7. ממצאי ביקורת (Audit Findings)

| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | יצירת ממצא | severity: high, finding, root_cause | ממצא נוצר בסטטוס open |
| 2 | הוספת CAPA | capa: "פעולה מתקנת", due_date | CAPA נשמר |
| 3 | סגירת ממצא | status: closed | הממצא מסומן כטופל |
| 4 | סינון לפי חומרה | severity: critical | רק ממצאים קריטיים מוצגים |

---

## 8. חריגות לוח שנה

| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | הוספת חג יום אחד | date: 2026-04-15, type: holiday | היום מדולג בחישוב CPM |
| 2 | הוספת חג רב-יומי | date: 2026-04-15, end_date: 2026-04-21 | כל הטווח מדולג |
| 3 | מחיקת חריגה | מחיקת חג | CPM מחושב מחדש |

---

## 9. ממשק משתמש (UI)

### 9.1 תצוגת משימות
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | הצגת כרטיס משימה | משימה עם כל הנתונים | כותרת, סטטוס, עדיפות, מבצעים, משך |
| 2 | צבע עדיפות | priority: critical | badge אדום |
| 3 | סימון נתיב קריטי | is_critical: true | סימון כחול |
| 4 | פתיחת סרגל צד | לחיצה על משימה | פרטי משימה מלאים + תאריכי CPM |

### 9.2 תרשים גנט
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | הצגת ציר זמן | פרויקט עם משימות | פסים בציר זמן לפי ES/EF |
| 2 | סימון נתיב קריטי | משימות קריטיות | הדגשה בצבע כחול |
| 3 | קו "היום" | תאריך נוכחי | קו אנכי מסמן את היום |

### 9.3 מטריקות
| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | משימות קריטיות | 3 משימות קריטיות | מוצג: "3 משימות קריטיות" |
| 2 | ימים שנותרו | סיום בעוד 15 יום | מוצג: "15 ימים" |
| 3 | אחוז השלמה | 6/10 משימות done | מוצג: "60%" |

---

## 10. אימות (Authentication)

| # | תרחיש | קלט | תוצאה צפויה |
|---|--------|------|-------------|
| 1 | התחברות תקינה | אימייל + סיסמה תקינים | כניסה לדשבורד |
| 2 | סיסמה שגויה | אימייל תקין + סיסמה שגויה | הודעת שגיאה |
| 3 | אימייל לא קיים | אימייל לא רשום | הודעת שגיאה |
| 4 | הרשמה חדשה | אימייל, סיסמה, אישור סיסמה | חשבון נוצר |
| 5 | סיסמאות לא תואמות | סיסמה != אישור סיסמה | שגיאת ולידציה |
| 6 | ניתוק | לחיצה על "התנתק" | חזרה למסך התחברות |

---

## 11. תרחישי קצה (Edge Cases)

| # | תרחיש | תוצאה צפויה |
|---|--------|-------------|
| 1 | פרויקט ללא משימות | דשבורד ריק עם הנחיה ליצירת משימה ראשונה |
| 2 | משימה עם duration=0 | ולידציה מונעת או מטופל כ-milestone |
| 3 | תלות מעגלית (A→B→C→A) | שגיאה מתאימה מוצגת למשתמש |
| 4 | 100 משימות עם תלויות מורכבות | CPM מחושב ללא תקיעה |
| 5 | שני פרויקטים פתוחים | מעבר חלק בין פרויקטים |
| 6 | חבר צוות מוקצה ל-5 משימות מקבילות | הקצאות מוצגות נכון |
| 7 | חופשה מאושרת שמכסה את כל משך המשימה | משך המשימה מתארך בהתאם |
| 8 | מחיקת חבר צוות שמוקצה למשימות | הקצאות מתעדכנות/מוסרות |

---

## סדר עדיפויות לבדיקה

1. **קריטי**: תזמון CPM, סנכרון סטטוס-התקדמות, תלויות
2. **גבוה**: ניהול משימות (CRUD), נעילת שלבים, לוח שנה
3. **בינוני**: צוות וחופשות, ממצאי ביקורת, UI
4. **נמוך**: אימות, מטריקות, edge cases
